---
title: "Models"
output: html_document
date: "2025-12-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
athlete_data <- read.csv("../data/cleaned_athlete_data.csv")
library(tidyverse)
library(ggplot2)
library(dplyr)

```


## Logisitc Model

```{r}
model1 <- glm(All.American ~ Days.since.Season.PR + Consistency + Season.Record + Personal.Record + Number.of.Races.Run, data = train_data, family = binomial)
summary(model1)
```

##Model Visualization

```{r}
#vizualize model1
train_data <- train_data %>%
  mutate(predicted_prob = predict(model1, type = "response"))
ggplot(train_data, aes(x = predicted_prob, fill = as.factor(All.American))) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
  scale_fill_manual(values = c("0" = "red", "1" = "blue"),
                    name = "All-American",
                    labels = c("No", "Yes")) +
  labs(
    title = "Predicted Probabilities of Being an All-American",
    x = "Predicted Probability",
    y = "Count"
  )

#make a logisitc curve for model1
ggplot(train_data, aes(x = Season.Record, y = predicted_prob, color = as.factor(All.American))) +
  geom_point() +
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE) +
  scale_color_manual(values = c("0" = "red", "1" = "blue"),
                     name = "All-American",
                     labels = c("No", "Yes")) +
  labs(
    title = "Logistic Curve of Predicted Probabilities by Season Record",
    x = "Season Record",
    y = "Predicted Probability"
  )
```

##Decision Tree Model
```{r}
library(rpart)
library(rpart.plot)
tree_model <- rpart(
  as.factor(All.American) ~ Days.since.Season.PR + Consistency + Season.Record + Personal.Record + Number.of.Races.Run,
  data = train_data,
  control = rpart.control(cp = 0.01)
)
rpart.plot(tree_model, main = "Decision Tree for All-American Prediction")
```
